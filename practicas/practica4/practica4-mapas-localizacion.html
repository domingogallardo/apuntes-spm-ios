



<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copiar al portapapeles">
      
        <meta name="lang:clipboard.copied" content="Copiado al portapapeles">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No se encontraron documentos">
      
        <meta name="lang:search.result.one" content="1 documento encontrado">
      
        <meta name="lang:search.result.other" content="# documentos encontrados">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>Práctica 4 - SPM-iOS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.1b62728e.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#practica-4-mapas-y-localizacion" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="SPM-iOS" class="md-header-nav__button md-logo">
          
            <img src="../../imagenes/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              SPM-iOS
            </span>
            <span class="md-header-nav__topic">
              
                Práctica 4
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Teclee para comenzar búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="SPM-iOS" class="md-nav__button md-logo">
      
        <img src="../../imagenes/logo.png" width="48" height="48">
      
    </a>
    SPM-iOS
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Teoría
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Teoría
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../teoria/tema0-introduccion-servicios-ios/introduccion-servicios-ios.html" title="0. Introducción" class="md-nav__link">
      0. Introducción
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../teoria/tema1-firma-aprovisionamiento/firma-aprovisionamiento.html" title="1. Firma, aprovisionamiento y distribución de apps" class="md-nav__link">
      1. Firma, aprovisionamiento y distribución de apps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../teoria/tema2-notificaciones/notificaciones.html" title="2. Notificaciones" class="md-nav__link">
      2. Notificaciones
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../teoria/tema3-icloud/icloud.html" title="3. iCloud y CloudKit" class="md-nav__link">
      3. iCloud y CloudKit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../teoria/tema4-mapas-localizacion/mapas-localizacion.html" title="4. Mapas y localización" class="md-nav__link">
      4. Mapas y localización
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../teoria/tema5-extensiones/extensiones.html" title="5. Extensiones" class="md-nav__link">
      5. Extensiones
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../teoria/tema6-anuncios/anuncios.html" title="6. Anuncios" class="md-nav__link">
      6. Anuncios
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../teoria/tema7-compras-in-app/compras-in-app.html" title="7. Compras InApp" class="md-nav__link">
      7. Compras InApp
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Prácticas
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Prácticas
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../practica1/practica1-firma-aprovisionamiento.html" title="Práctica 1" class="md-nav__link">
      Práctica 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../practica2/practica2-notificaciones.html" title="Práctica 2" class="md-nav__link">
      Práctica 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../practica3/practica3-icloud.html" title="Práctica 3" class="md-nav__link">
      Práctica 3
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="practica4-mapas-localizacion.html" title="Práctica 4" class="md-nav__link md-nav__link--active">
      Práctica 4
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../practica5/practica5-extensiones.html" title="Práctica 5" class="md-nav__link">
      Práctica 5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../practica6/practica6-anuncios.html" title="Práctica 6" class="md-nav__link">
      Práctica 6
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <!--
Terminan la práctica en unas 1,5 horas + 1 hora de explicación = 2,5 horas
-->

<h1 id="practica-4-mapas-y-localizacion">Práctica 4: Mapas y localización<a class="headerlink" href="#practica-4-mapas-y-localizacion" title="Permanent link">&para;</a></h1>
<ol>
<li>Debes crear la app <code>es.ua.mastermoviles.Mapas</code>.</li>
<li>Empieza por definir un <em>View Controller</em> en el que debes incluir un
mapa centrado inicialmente en Alicante. Inclúyelo en un <em>Navigation Controller</em> con la
opción <em>Editor &gt; Embed In &gt; Navigation Controller</em>.</li>
<li>Añade en el centro de la barra del <em>Navigation Controller</em> un
<em>Segmented Control</em> con los valores <code>Mapa</code> y <code>Satélite</code>, conéctalos
con el <em>ViewController</em> y haz que el mapa cambie de tipo cuando se
pulse en el control.</li>
</ol>
<p style="text-align:center;">
<img src="imagenes/practica-1.png" width="300px"/>
</p>

<ol start="4">
<li>En el <em>Storyboard</em> añade un <code>Bar Button Item</code> en la parte derecha de
la barra de navegación.</li>
<li>Llámalo <code>Pin</code> y enlázalo con una acción en el <code>ViewController</code> que
  añada una anotación en el mapa.</li>
</ol>
<p style="text-align:center;">
<img src="imagenes/practica-2.png" width="300px"/>
</p>

<ol start="6">
<li>Añade en los <em>callouts</em> imágenes <em>thumbnails</em> predefinidas,
dependiendo de si el número de pin es par o impar.</li>
<li>Añade en los <em>callouts</em> el botón de información.</li>
</ol>
<p style="text-align:center;">
<img src="imagenes/practica-3.png" width="300px"/>
</p>

<p><strong>Parte opcional 1</strong></p>
<ol start="8">
<li>Implementa un <em>segue</em> que haga aparecer otra vista con un detalle
  de la foto.</li>
</ol>
<p style="text-align:center;">
<img src="imagenes/storyboard.png" width="500px"/> 
<img src="imagenes/practica-4.png" width="200px"/>
</p>

<p>Pista 1 (Segue):</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">func</span> <span class="nf">mapView</span><span class="p">(</span><span class="kc">_</span> <span class="n">mapView</span><span class="p">:</span> <span class="bp">MKMapView</span><span class="p">,</span> <span class="n">annotationView</span> <span class="n">view</span><span class="p">:</span> <span class="bp">MKAnnotationView</span><span class="p">,</span> <span class="n">calloutAccessoryControlTapped</span> <span class="n">control</span><span class="p">:</span> <span class="bp">UIControl</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">performSegue</span><span class="p">(</span><span class="n">withIdentifier</span><span class="p">:</span> <span class="s">&quot;DetalleImagen&quot;</span><span class="p">,</span> <span class="n">sender</span><span class="p">:</span> <span class="n">view</span><span class="p">)</span>
<span class="p">}</span>

<span class="kr">override</span> <span class="kd">func</span> <span class="nf">prepare</span><span class="p">(</span><span class="k">for</span> <span class="n">segue</span><span class="p">:</span> <span class="bp">UIStoryboardSegue</span><span class="p">,</span> <span class="n">sender</span><span class="p">:</span> <span class="nb">Any</span><span class="p">?)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="n">segue</span><span class="p">.</span><span class="n">identifier</span> <span class="p">==</span> <span class="s">&quot;DetalleImagen&quot;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="kd">let</span> <span class="nv">pin</span> <span class="p">=</span> <span class="p">(</span><span class="n">sender</span> <span class="k">as</span><span class="p">?</span> <span class="bp">MKAnnotationView</span><span class="p">)?.</span><span class="n">annotation</span> <span class="k">as</span><span class="p">?</span> <span class="n">Pin</span> <span class="p">{</span>
            <span class="k">if</span> <span class="kd">let</span> <span class="nv">vc</span> <span class="p">=</span> <span class="n">segue</span><span class="p">.</span><span class="n">destination</span> <span class="k">as</span><span class="p">?</span> <span class="n">MiImageViewController</span> <span class="p">{</span>
                <span class="n">vc</span><span class="p">.</span><span class="n">imageDetail</span> <span class="p">=</span> <span class="n">pin</span><span class="p">.</span><span class="n">thumbImage</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Pista 2 (<code>ViewController</code> de la vista detalle):</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">class</span> <span class="nc">ImageDetailViewController</span><span class="p">:</span> <span class="bp">UIViewController</span> <span class="p">{</span>

    <span class="kr">@IBOutlet</span> <span class="kr">weak</span> <span class="kd">var</span> <span class="nv">imageView</span><span class="p">:</span> <span class="bp">UIImageView</span><span class="p">!</span>
    <span class="kd">var</span> <span class="nv">imageDetail</span><span class="p">:</span> <span class="bp">UIImage</span><span class="p">?</span> <span class="p">=</span> <span class="kc">nil</span>

    <span class="kr">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="kc">super</span><span class="p">.</span><span class="n">viewDidLoad</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">imageDetail</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="n">imageView</span><span class="p">.</span><span class="n">image</span> <span class="p">=</span> <span class="n">imageDetail</span><span class="p">!</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p><strong>Parte opcional 2</strong></p>
<ol start="9">
<li>Implementa una llamada al servicio de geolocalización que coloque
   como subtítulo del Pin el país en el que se ha colocado el
   mismo. </li>
</ol>
<p style="text-align:center;">
<img src="imagenes/mapa-con-pais.png" width="300px"/>
</p>

<p><strong>Parte opcional 3</strong></p>
<ol start="10">
<li>
<p>Añade el tracking de localización a la aplicación, imprimiendo la
localización en la salida estándar cada 10 metros. Comprueba el
funcionamiento activando la localización en el simulador.</p>
</li>
<li>
<p>Añade la localización al mapa, haciendo que aparezca en la parte
izquierda de la barra de navegación el botón de navegación.</p>
<ul>
<li>
<p>Cuando pulses el botón de navegación se debe mostrar la posición
  actual del dispositivo.</p>
</li>
<li>
<p>Deberás modificar la función que muestra la vista de una
  anotación
  (<a href="https://developer.apple.com/reference/mapkit/mkmapviewdelegate/1452045-mapview"><code>mapView(_:viewFor:)</code></a>)
  porque se utiliza también para mostrar la vista de la posición
  actual del dispositivo (que también es una anotación). Si la
  anotación que se quiere mostrar no es de tipo Pin debes poner la
  vista a <code>nil</code> para que se use la vista por defecto (el círculo).</p>
</li>
</ul>
</li>
</ol>
<p style="text-align:center;">
<img src="imagenes/localizacion.png" width="300px"/>
</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../practica3/practica3-icloud.html" title="Práctica 3" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Anterior
                </span>
                Práctica 3
              </span>
            </div>
          </a>
        
        
          <a href="../practica5/practica5-extensiones.html" title="Práctica 5" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Siguiente
                </span>
                Práctica 5
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>